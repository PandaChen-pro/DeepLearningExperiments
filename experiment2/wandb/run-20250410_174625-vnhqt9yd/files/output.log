Files already downloaded and verified
Files already downloaded and verified
/data/coding/deep_learning_experiments/experiment2/start.py:64: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(checkpoint_path, map_location=device)
Epoch 1/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [02:09<00:00,  1.32s/it]
Epoch 1, Batch 0, Loss: 0.9073, learning_rate: 0.000001
Epoch 1, Batch 30, Loss: 0.8543, learning_rate: 0.000004
Epoch 1, Batch 60, Loss: 0.8697, learning_rate: 0.000007
Epoch 1, Batch 90, Loss: 0.9196, learning_rate: 0.000010
Epoch [1/50] - Loss: 0.8797, Accuracy: 83.10%
Starting validation...
Validation Loss: 1.0729, Validation Accuracy: 77.56%
Epoch 1/50, Val Loss: 1.0729, Val Acc: 77.56%
保存模型到 ./checkpoints/ViT_Original_0410_Val_Epoch1_Acc77.56.pth
Epoch 2/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [02:06<00:00,  1.29s/it]
Epoch 2, Batch 0, Loss: 0.8638, learning_rate: 0.000011
Epoch 2, Batch 30, Loss: 0.8367, learning_rate: 0.000014
Epoch 2, Batch 60, Loss: 0.8302, learning_rate: 0.000017
Epoch 2, Batch 90, Loss: 0.8800, learning_rate: 0.000020
Epoch [2/50] - Loss: 0.8614, Accuracy: 84.18%
Starting validation...
Validation Loss: 1.1065, Validation Accuracy: 76.73%
Epoch 2/50, Val Loss: 1.1065, Val Acc: 76.73%
验证准确率未提升，早停计数: 1/10
Epoch 3/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [02:09<00:00,  1.32s/it]
Epoch 3, Batch 0, Loss: 0.8073, learning_rate: 0.000021
Epoch 3, Batch 30, Loss: 0.8672, learning_rate: 0.000024
Epoch 3, Batch 60, Loss: 0.9250, learning_rate: 0.000027
Epoch 3, Batch 90, Loss: 0.8570, learning_rate: 0.000030
Epoch [3/50] - Loss: 0.8580, Accuracy: 84.47%
Starting validation...
Validation Loss: 1.0734, Validation Accuracy: 78.02%
Epoch 3/50, Val Loss: 1.0734, Val Acc: 78.02%
删除旧的最佳模型: ./checkpoints/ViT_Original_0410_Val_Epoch1_Acc77.56.pth
保存模型到 ./checkpoints/ViT_Original_0410_Val_Epoch3_Acc78.02.pth
Epoch 4/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [02:07<00:00,  1.30s/it]
Epoch 4, Batch 0, Loss: 0.9399, learning_rate: 0.000031
Epoch 4, Batch 30, Loss: 0.8911, learning_rate: 0.000034
Epoch 4, Batch 60, Loss: 0.8905, learning_rate: 0.000037
Epoch 4, Batch 90, Loss: 0.9329, learning_rate: 0.000040
Epoch [4/50] - Loss: 0.9066, Accuracy: 81.81%
Starting validation...
Validation Loss: 1.1033, Validation Accuracy: 76.79%
Epoch 4/50, Val Loss: 1.1033, Val Acc: 76.79%
验证准确率未提升，早停计数: 1/10
Epoch 5/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [02:09<00:00,  1.32s/it]
Epoch 5, Batch 0, Loss: 0.9569, learning_rate: 0.000041
Epoch 5, Batch 30, Loss: 0.9647, learning_rate: 0.000044
Epoch 5, Batch 60, Loss: 0.9396, learning_rate: 0.000047
Epoch 5, Batch 90, Loss: 0.8820, learning_rate: 0.000050
Epoch [5/50] - Loss: 0.9156, Accuracy: 81.37%
Starting validation...
Validation Loss: 1.0705, Validation Accuracy: 77.18%
Epoch 5/50, Val Loss: 1.0705, Val Acc: 77.18%
验证准确率未提升，早停计数: 2/10
Epoch 6/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [02:06<00:00,  1.29s/it]
Epoch 6, Batch 0, Loss: 0.8857, learning_rate: 0.000051
Epoch 6, Batch 30, Loss: 0.8913, learning_rate: 0.000054
Epoch 6, Batch 60, Loss: 0.9505, learning_rate: 0.000057
Epoch 6, Batch 90, Loss: 0.8909, learning_rate: 0.000060
Epoch [6/50] - Loss: 0.9129, Accuracy: 81.51%
Starting validation...
Validation Loss: 1.1107, Validation Accuracy: 75.75%
Epoch 6/50, Val Loss: 1.1107, Val Acc: 75.75%
验证准确率未提升，早停计数: 3/10
Epoch 7/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [02:08<00:00,  1.31s/it]
Epoch 7, Batch 0, Loss: 0.8860, learning_rate: 0.000060
Epoch 7, Batch 30, Loss: 0.9229, learning_rate: 0.000063
Epoch 7, Batch 60, Loss: 0.8889, learning_rate: 0.000066
Epoch 7, Batch 90, Loss: 0.9325, learning_rate: 0.000069
Epoch [7/50] - Loss: 0.9223, Accuracy: 81.10%
Starting validation...
Validation Loss: 1.0772, Validation Accuracy: 77.13%
Epoch 7/50, Val Loss: 1.0772, Val Acc: 77.13%
验证准确率未提升，早停计数: 4/10
Epoch 8/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [02:13<00:00,  1.36s/it]
Epoch 8, Batch 0, Loss: 0.9784, learning_rate: 0.000070
Epoch 8, Batch 30, Loss: 0.9641, learning_rate: 0.000073
Epoch 8, Batch 60, Loss: 0.9036, learning_rate: 0.000076
Epoch 8, Batch 90, Loss: 0.9584, learning_rate: 0.000079
Epoch [8/50] - Loss: 0.9318, Accuracy: 80.53%
Starting validation...
Validation Loss: 1.1132, Validation Accuracy: 75.67%
Epoch 8/50, Val Loss: 1.1132, Val Acc: 75.67%
验证准确率未提升，早停计数: 5/10
Epoch 9/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [02:08<00:00,  1.31s/it]
Epoch 9, Batch 0, Loss: 0.9514, learning_rate: 0.000080
Epoch 9, Batch 30, Loss: 0.8807, learning_rate: 0.000083
Epoch 9, Batch 60, Loss: 0.9172, learning_rate: 0.000086
Epoch 9, Batch 90, Loss: 0.9321, learning_rate: 0.000089
Epoch [9/50] - Loss: 0.9353, Accuracy: 80.52%
Starting validation...
Validation Loss: 1.0799, Validation Accuracy: 76.99%
Epoch 9/50, Val Loss: 1.0799, Val Acc: 76.99%
验证准确率未提升，早停计数: 6/10
Epoch 10/50: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [02:08<00:00,  1.31s/it]
Epoch 10, Batch 0, Loss: 0.9192, learning_rate: 0.000090
Epoch 10, Batch 30, Loss: 0.9134, learning_rate: 0.000093
Epoch 10, Batch 60, Loss: 0.9465, learning_rate: 0.000096
Epoch 10, Batch 90, Loss: 1.0158, learning_rate: 0.000099
Epoch [10/50] - Loss: 0.9456, Accuracy: 80.03%
Starting validation...
Validation Loss: 1.0925, Validation Accuracy: 76.45%
Epoch 10/50, Val Loss: 1.0925, Val Acc: 76.45%
验证准确率未提升，早停计数: 7/10
Epoch 11/50: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [02:09<00:00,  1.32s/it]
Epoch 11, Batch 0, Loss: 0.9394, learning_rate: 0.000100
Epoch 11, Batch 30, Loss: 0.8843, learning_rate: 0.000100
Epoch 11, Batch 60, Loss: 0.8702, learning_rate: 0.000100
Epoch 11, Batch 90, Loss: 0.9491, learning_rate: 0.000100
Epoch [11/50] - Loss: 0.9430, Accuracy: 79.83%
Starting validation...
Validation Loss: 1.0870, Validation Accuracy: 77.03%
Epoch 11/50, Val Loss: 1.0870, Val Acc: 77.03%
验证准确率未提升，早停计数: 8/10
Epoch 12/50: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [02:11<00:00,  1.34s/it]
Epoch 12, Batch 0, Loss: 0.9428, learning_rate: 0.000100
Epoch 12, Batch 30, Loss: 0.9257, learning_rate: 0.000100
Epoch 12, Batch 60, Loss: 0.9524, learning_rate: 0.000100
Epoch 12, Batch 90, Loss: 0.9603, learning_rate: 0.000100
Epoch [12/50] - Loss: 0.9425, Accuracy: 80.02%
Starting validation...
Validation Loss: 1.1219, Validation Accuracy: 76.09%
Epoch 12/50, Val Loss: 1.1219, Val Acc: 76.09%
验证准确率未提升，早停计数: 9/10
Epoch 13/50: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [02:06<00:00,  1.29s/it]
Epoch 13, Batch 0, Loss: 1.0248, learning_rate: 0.000100
Epoch 13, Batch 30, Loss: 0.9974, learning_rate: 0.000100
Epoch 13, Batch 60, Loss: 0.9681, learning_rate: 0.000099
Epoch 13, Batch 90, Loss: 0.9614, learning_rate: 0.000099
Epoch [13/50] - Loss: 0.9388, Accuracy: 80.34%
Starting validation...
Validation Loss: 1.0703, Validation Accuracy: 77.07%
Epoch 13/50, Val Loss: 1.0703, Val Acc: 77.07%
验证准确率未提升，早停计数: 10/10
Epoch 14/50: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [02:08<00:00,  1.31s/it]
Epoch 14, Batch 0, Loss: 0.9500, learning_rate: 0.000099
Epoch 14, Batch 30, Loss: 0.9306, learning_rate: 0.000099
Epoch 14, Batch 60, Loss: 0.9698, learning_rate: 0.000099
Epoch 14, Batch 90, Loss: 0.8851, learning_rate: 0.000099
Epoch [14/50] - Loss: 0.9409, Accuracy: 80.07%
Starting validation...
Validation Loss: 1.0718, Validation Accuracy: 77.07%
Epoch 14/50, Val Loss: 1.0718, Val Acc: 77.07%
验证准确率未提升，早停计数: 11/10
Epoch 15/50: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [02:06<00:00,  1.29s/it]
Epoch 15, Batch 0, Loss: 0.9468, learning_rate: 0.000099
Epoch 15, Batch 30, Loss: 0.9554, learning_rate: 0.000098
Epoch 15, Batch 60, Loss: 0.9321, learning_rate: 0.000098
Epoch 15, Batch 90, Loss: 0.9709, learning_rate: 0.000098
Epoch [15/50] - Loss: 0.9355, Accuracy: 80.25%
Starting validation...
Validation Loss: 1.0915, Validation Accuracy: 76.20%
Epoch 15/50, Val Loss: 1.0915, Val Acc: 76.20%
验证准确率未提升，早停计数: 12/10
Epoch 16/50: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [02:09<00:00,  1.32s/it]
Epoch 16, Batch 0, Loss: 0.9405, learning_rate: 0.000098
Epoch 16, Batch 30, Loss: 0.9326, learning_rate: 0.000098
Epoch 16, Batch 60, Loss: 0.9236, learning_rate: 0.000097
Epoch 16, Batch 90, Loss: 0.9412, learning_rate: 0.000097
Epoch [16/50] - Loss: 0.9293, Accuracy: 80.75%
Starting validation...
Validation Loss: 1.0687, Validation Accuracy: 77.53%
Epoch 16/50, Val Loss: 1.0687, Val Acc: 77.53%
验证准确率未提升，早停计数: 13/10
Epoch 17/50: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [02:09<00:00,  1.32s/it]
Epoch 17, Batch 0, Loss: 0.9132, learning_rate: 0.000097
Epoch 17, Batch 30, Loss: 0.9046, learning_rate: 0.000097
Epoch 17, Batch 60, Loss: 0.9525, learning_rate: 0.000096
Epoch 17, Batch 90, Loss: 0.8872, learning_rate: 0.000096
Epoch [17/50] - Loss: 0.9232, Accuracy: 80.92%
Starting validation...
Validation Loss: 1.0687, Validation Accuracy: 77.17%
Epoch 17/50, Val Loss: 1.0687, Val Acc: 77.17%
验证准确率未提升，早停计数: 14/10
Epoch 18/50: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [02:06<00:00,  1.29s/it]
Epoch 18, Batch 0, Loss: 0.8823, learning_rate: 0.000096
Epoch 18, Batch 30, Loss: 0.8967, learning_rate: 0.000095
Epoch 18, Batch 60, Loss: 0.9145, learning_rate: 0.000095
Epoch 18, Batch 90, Loss: 0.9386, learning_rate: 0.000095
Epoch [18/50] - Loss: 0.9202, Accuracy: 81.14%
Starting validation...
Validation Loss: 1.0632, Validation Accuracy: 77.64%
Epoch 18/50, Val Loss: 1.0632, Val Acc: 77.64%
验证准确率未提升，早停计数: 15/10
Epoch 19/50: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [02:11<00:00,  1.34s/it]
Epoch 19, Batch 0, Loss: 0.9192, learning_rate: 0.000094
Epoch 19, Batch 30, Loss: 0.9000, learning_rate: 0.000094
Epoch 19, Batch 60, Loss: 0.9561, learning_rate: 0.000094
Epoch 19, Batch 90, Loss: 0.9179, learning_rate: 0.000093
Epoch [19/50] - Loss: 0.9132, Accuracy: 81.34%
Starting validation...
Validation Loss: 1.0998, Validation Accuracy: 76.61%
Epoch 19/50, Val Loss: 1.0998, Val Acc: 76.61%
验证准确率未提升，早停计数: 16/10
Epoch 20/50: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [02:14<00:00,  1.38s/it]
Epoch 20, Batch 0, Loss: 0.8999, learning_rate: 0.000093
Epoch 20, Batch 30, Loss: 0.9330, learning_rate: 0.000093
Epoch 20, Batch 60, Loss: 0.9058, learning_rate: 0.000092
Epoch 20, Batch 90, Loss: 0.9249, learning_rate: 0.000092
Epoch [20/50] - Loss: 0.9170, Accuracy: 81.26%
Starting validation...
Validation Loss: 1.0531, Validation Accuracy: 78.04%
Epoch 20/50, Val Loss: 1.0531, Val Acc: 78.04%
删除旧的最佳模型: ./checkpoints/ViT_Original_0410_Val_Epoch3_Acc78.02.pth
保存模型到 ./checkpoints/ViT_Original_0410_Val_Epoch20_Acc78.04.pth
Epoch 21/50: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [02:11<00:00,  1.34s/it]
Epoch 21, Batch 0, Loss: 0.8904, learning_rate: 0.000091
Epoch 21, Batch 30, Loss: 0.8906, learning_rate: 0.000091
Epoch 21, Batch 60, Loss: 0.9225, learning_rate: 0.000090
Epoch 21, Batch 90, Loss: 0.9515, learning_rate: 0.000090
Epoch [21/50] - Loss: 0.9126, Accuracy: 81.44%
Starting validation...
Validation Loss: 1.0632, Validation Accuracy: 77.80%
Epoch 21/50, Val Loss: 1.0632, Val Acc: 77.80%
验证准确率未提升，早停计数: 1/10
Epoch 22/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [02:09<00:00,  1.32s/it]
Epoch 22, Batch 0, Loss: 0.8547, learning_rate: 0.000090
Epoch 22, Batch 30, Loss: 0.9140, learning_rate: 0.000089
Epoch 22, Batch 60, Loss: 0.9307, learning_rate: 0.000089
Epoch 22, Batch 90, Loss: 0.8946, learning_rate: 0.000088
Epoch [22/50] - Loss: 0.9036, Accuracy: 81.88%
Starting validation...
Validation Loss: 1.0653, Validation Accuracy: 77.69%
Epoch 22/50, Val Loss: 1.0653, Val Acc: 77.69%
验证准确率未提升，早停计数: 2/10
Epoch 23/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [02:08<00:00,  1.31s/it]
Epoch 23, Batch 0, Loss: 0.9159, learning_rate: 0.000088
Epoch 23, Batch 30, Loss: 0.8681, learning_rate: 0.000087
Epoch 23, Batch 60, Loss: 0.9105, learning_rate: 0.000087
Epoch 23, Batch 90, Loss: 0.8561, learning_rate: 0.000086
Epoch [23/50] - Loss: 0.8961, Accuracy: 82.26%
Starting validation...
Validation Loss: 1.0513, Validation Accuracy: 78.08%
Epoch 23/50, Val Loss: 1.0513, Val Acc: 78.08%
删除旧的最佳模型: ./checkpoints/ViT_Original_0410_Val_Epoch20_Acc78.04.pth
保存模型到 ./checkpoints/ViT_Original_0410_Val_Epoch23_Acc78.08.pth
Epoch 24/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [02:08<00:00,  1.31s/it]
Epoch 24, Batch 0, Loss: 0.9471, learning_rate: 0.000086
Epoch 24, Batch 30, Loss: 0.9179, learning_rate: 0.000085
Epoch 24, Batch 60, Loss: 0.9388, learning_rate: 0.000085
Epoch 24, Batch 90, Loss: 0.9152, learning_rate: 0.000084
Epoch [24/50] - Loss: 0.8961, Accuracy: 82.17%
Starting validation...
Validation Loss: 1.0401, Validation Accuracy: 78.40%
Epoch 24/50, Val Loss: 1.0401, Val Acc: 78.40%
删除旧的最佳模型: ./checkpoints/ViT_Original_0410_Val_Epoch23_Acc78.08.pth
保存模型到 ./checkpoints/ViT_Original_0410_Val_Epoch24_Acc78.40.pth
Epoch 25/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [02:08<00:00,  1.31s/it]
Epoch 25, Batch 0, Loss: 0.9361, learning_rate: 0.000084
Epoch 25, Batch 30, Loss: 0.9089, learning_rate: 0.000083
Epoch 25, Batch 60, Loss: 0.9284, learning_rate: 0.000082
Epoch 25, Batch 90, Loss: 0.8833, learning_rate: 0.000082
Epoch [25/50] - Loss: 0.8958, Accuracy: 82.27%
Starting validation...
Validation Loss: 1.0767, Validation Accuracy: 77.66%
Epoch 25/50, Val Loss: 1.0767, Val Acc: 77.66%
验证准确率未提升，早停计数: 1/10
Epoch 26/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [02:08<00:00,  1.32s/it]
Epoch 26, Batch 0, Loss: 0.8835, learning_rate: 0.000081
Epoch 26, Batch 30, Loss: 0.9193, learning_rate: 0.000081
Epoch 26, Batch 60, Loss: 0.8325, learning_rate: 0.000080
Epoch 26, Batch 90, Loss: 0.8758, learning_rate: 0.000079
Epoch [26/50] - Loss: 0.8840, Accuracy: 82.88%
Starting validation...
Validation Loss: 1.0734, Validation Accuracy: 77.44%
Epoch 26/50, Val Loss: 1.0734, Val Acc: 77.44%
验证准确率未提升，早停计数: 2/10
Epoch 27/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [02:09<00:00,  1.32s/it]
Epoch 27, Batch 0, Loss: 0.8165, learning_rate: 0.000079
Epoch 27, Batch 30, Loss: 0.8807, learning_rate: 0.000078
Epoch 27, Batch 60, Loss: 0.9287, learning_rate: 0.000078
Epoch 27, Batch 90, Loss: 0.8097, learning_rate: 0.000077
Epoch [27/50] - Loss: 0.8813, Accuracy: 82.96%
Starting validation...
Validation Loss: 1.0799, Validation Accuracy: 77.49%
Epoch 27/50, Val Loss: 1.0799, Val Acc: 77.49%
验证准确率未提升，早停计数: 3/10
Epoch 28/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [02:10<00:00,  1.33s/it]
Epoch 28, Batch 0, Loss: 0.8646, learning_rate: 0.000077
Epoch 28, Batch 30, Loss: 0.8476, learning_rate: 0.000076
Epoch 28, Batch 60, Loss: 0.8540, learning_rate: 0.000075
Epoch 28, Batch 90, Loss: 0.9076, learning_rate: 0.000074
Epoch [28/50] - Loss: 0.8779, Accuracy: 83.16%
Starting validation...
Validation Loss: 1.0785, Validation Accuracy: 77.94%
Epoch 28/50, Val Loss: 1.0785, Val Acc: 77.94%
验证准确率未提升，早停计数: 4/10
Epoch 29/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [02:09<00:00,  1.32s/it]
Epoch 29, Batch 0, Loss: 0.8904, learning_rate: 0.000074
Epoch 29, Batch 30, Loss: 0.8646, learning_rate: 0.000073
Epoch 29, Batch 60, Loss: 0.8473, learning_rate: 0.000073
Epoch 29, Batch 90, Loss: 0.9329, learning_rate: 0.000072
Epoch [29/50] - Loss: 0.8720, Accuracy: 83.21%
Starting validation...
Validation Loss: 1.0814, Validation Accuracy: 77.89%
Epoch 29/50, Val Loss: 1.0814, Val Acc: 77.89%
验证准确率未提升，早停计数: 5/10
Epoch 30/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [02:10<00:00,  1.33s/it]
Epoch 30, Batch 0, Loss: 0.8877, learning_rate: 0.000072
Epoch 30, Batch 30, Loss: 0.8793, learning_rate: 0.000071
Epoch 30, Batch 60, Loss: 0.8941, learning_rate: 0.000070
Epoch 30, Batch 90, Loss: 0.8602, learning_rate: 0.000069
Epoch [30/50] - Loss: 0.8685, Accuracy: 83.54%
Starting validation...
Validation Loss: 1.0995, Validation Accuracy: 76.99%
Epoch 30/50, Val Loss: 1.0995, Val Acc: 76.99%
验证准确率未提升，早停计数: 6/10
Epoch 31/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [02:09<00:00,  1.33s/it]
Epoch 31, Batch 0, Loss: 0.8966, learning_rate: 0.000069
Epoch 31, Batch 30, Loss: 0.8844, learning_rate: 0.000068
Epoch 31, Batch 60, Loss: 0.8608, learning_rate: 0.000067
Epoch 31, Batch 90, Loss: 0.8311, learning_rate: 0.000066
Epoch [31/50] - Loss: 0.8690, Accuracy: 83.74%
Starting validation...
Validation Loss: 1.0605, Validation Accuracy: 78.16%
Epoch 31/50, Val Loss: 1.0605, Val Acc: 78.16%
验证准确率未提升，早停计数: 7/10
Epoch 32/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [02:10<00:00,  1.33s/it]
Epoch 32, Batch 0, Loss: 0.8371, learning_rate: 0.000066
Epoch 32, Batch 30, Loss: 0.8751, learning_rate: 0.000065
Epoch 32, Batch 60, Loss: 0.8527, learning_rate: 0.000065
Epoch 32, Batch 90, Loss: 0.8973, learning_rate: 0.000064
Epoch [32/50] - Loss: 0.8579, Accuracy: 83.93%
Starting validation...
Validation Loss: 1.0743, Validation Accuracy: 77.64%
Epoch 32/50, Val Loss: 1.0743, Val Acc: 77.64%
验证准确率未提升，早停计数: 8/10
Epoch 33/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [02:06<00:00,  1.30s/it]
Epoch 33, Batch 0, Loss: 0.8566, learning_rate: 0.000063
Epoch 33, Batch 30, Loss: 0.9008, learning_rate: 0.000063
Epoch 33, Batch 60, Loss: 0.9074, learning_rate: 0.000062
Epoch 33, Batch 90, Loss: 0.8911, learning_rate: 0.000061
Epoch [33/50] - Loss: 0.8516, Accuracy: 84.30%
Starting validation...
Validation Loss: 1.0718, Validation Accuracy: 78.14%
Epoch 33/50, Val Loss: 1.0718, Val Acc: 78.14%
验证准确率未提升，早停计数: 9/10
Epoch 34/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [02:08<00:00,  1.31s/it]
Epoch 34, Batch 0, Loss: 0.8439, learning_rate: 0.000061
Epoch 34, Batch 30, Loss: 0.8142, learning_rate: 0.000060
Epoch 34, Batch 60, Loss: 0.7984, learning_rate: 0.000059
Epoch 34, Batch 90, Loss: 0.8415, learning_rate: 0.000058
Epoch [34/50] - Loss: 0.8490, Accuracy: 84.43%
Starting validation...
Validation Loss: 1.0729, Validation Accuracy: 78.09%
Epoch 34/50, Val Loss: 1.0729, Val Acc: 78.09%
验证准确率未提升，早停计数: 10/10
Epoch 35/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [02:11<00:00,  1.34s/it]
Epoch 35, Batch 0, Loss: 0.8867, learning_rate: 0.000058
Epoch 35, Batch 30, Loss: 0.8261, learning_rate: 0.000057
Epoch 35, Batch 60, Loss: 0.8010, learning_rate: 0.000056
Epoch 35, Batch 90, Loss: 0.8532, learning_rate: 0.000055
Epoch [35/50] - Loss: 0.8431, Accuracy: 84.71%
Starting validation...
Validation Loss: 1.0447, Validation Accuracy: 79.34%
Epoch 35/50, Val Loss: 1.0447, Val Acc: 79.34%
删除旧的最佳模型: ./checkpoints/ViT_Original_0410_Val_Epoch24_Acc78.40.pth
保存模型到 ./checkpoints/ViT_Original_0410_Val_Epoch35_Acc79.34.pth
Epoch 36/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [02:10<00:00,  1.33s/it]
Epoch 36, Batch 0, Loss: 0.8000, learning_rate: 0.000055
Epoch 36, Batch 30, Loss: 0.7995, learning_rate: 0.000054
Epoch 36, Batch 60, Loss: 0.8838, learning_rate: 0.000053
Epoch 36, Batch 90, Loss: 0.9196, learning_rate: 0.000052
Epoch [36/50] - Loss: 0.8359, Accuracy: 84.92%
Starting validation...
Validation Loss: 1.0646, Validation Accuracy: 78.52%
Epoch 36/50, Val Loss: 1.0646, Val Acc: 78.52%
验证准确率未提升，早停计数: 1/10
Epoch 37/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [02:14<00:00,  1.37s/it]
Epoch 37, Batch 0, Loss: 0.8850, learning_rate: 0.000052
Epoch 37, Batch 30, Loss: 0.8604, learning_rate: 0.000051
Epoch 37, Batch 60, Loss: 0.8351, learning_rate: 0.000050
Epoch 37, Batch 90, Loss: 0.8316, learning_rate: 0.000050
Epoch [37/50] - Loss: 0.8311, Accuracy: 85.29%
Starting validation...
Validation Loss: 1.0648, Validation Accuracy: 78.96%
Epoch 37/50, Val Loss: 1.0648, Val Acc: 78.96%
验证准确率未提升，早停计数: 2/10
Epoch 38/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [02:11<00:00,  1.34s/it]
Epoch 38, Batch 0, Loss: 0.8232, learning_rate: 0.000049
Epoch 38, Batch 30, Loss: 0.8286, learning_rate: 0.000049
Epoch 38, Batch 60, Loss: 0.8412, learning_rate: 0.000048
Epoch 38, Batch 90, Loss: 0.8102, learning_rate: 0.000047
Epoch [38/50] - Loss: 0.8293, Accuracy: 85.42%
Starting validation...
Validation Loss: 1.0605, Validation Accuracy: 78.83%
Epoch 38/50, Val Loss: 1.0605, Val Acc: 78.83%
验证准确率未提升，早停计数: 3/10
Epoch 39/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [02:07<00:00,  1.30s/it]
Epoch 39, Batch 0, Loss: 0.7717, learning_rate: 0.000047
Epoch 39, Batch 30, Loss: 0.7950, learning_rate: 0.000046
Epoch 39, Batch 60, Loss: 0.8182, learning_rate: 0.000045
Epoch 39, Batch 90, Loss: 0.7619, learning_rate: 0.000044
Epoch [39/50] - Loss: 0.8204, Accuracy: 85.71%
Starting validation...
Validation Loss: 1.0941, Validation Accuracy: 78.02%
Epoch 39/50, Val Loss: 1.0941, Val Acc: 78.02%
验证准确率未提升，早停计数: 4/10
Epoch 40/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [02:07<00:00,  1.30s/it]
Epoch 40, Batch 0, Loss: 0.8302, learning_rate: 0.000044
Epoch 40, Batch 30, Loss: 0.8085, learning_rate: 0.000043
Epoch 40, Batch 60, Loss: 0.7920, learning_rate: 0.000042
Epoch 40, Batch 90, Loss: 0.8315, learning_rate: 0.000041
Epoch [40/50] - Loss: 0.8161, Accuracy: 85.97%
Starting validation...
Validation Loss: 1.0742, Validation Accuracy: 78.34%
Epoch 40/50, Val Loss: 1.0742, Val Acc: 78.34%
验证准确率未提升，早停计数: 5/10
Epoch 41/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [02:09<00:00,  1.32s/it]
Epoch 41, Batch 0, Loss: 0.8248, learning_rate: 0.000041
Epoch 41, Batch 30, Loss: 0.8277, learning_rate: 0.000040
Epoch 41, Batch 60, Loss: 0.8174, learning_rate: 0.000039
Epoch 41, Batch 90, Loss: 0.7980, learning_rate: 0.000039
Epoch [41/50] - Loss: 0.8139, Accuracy: 86.09%
Starting validation...
Validation Loss: 1.1098, Validation Accuracy: 77.14%
Epoch 41/50, Val Loss: 1.1098, Val Acc: 77.14%
验证准确率未提升，早停计数: 6/10
Epoch 42/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [02:08<00:00,  1.31s/it]
Epoch 42, Batch 0, Loss: 0.8582, learning_rate: 0.000038
Epoch 42, Batch 30, Loss: 0.8093, learning_rate: 0.000038
Epoch 42, Batch 60, Loss: 0.8097, learning_rate: 0.000037
Epoch 42, Batch 90, Loss: 0.8139, learning_rate: 0.000036
Epoch [42/50] - Loss: 0.8062, Accuracy: 86.28%
Starting validation...
Validation Loss: 1.0590, Validation Accuracy: 78.94%
Epoch 42/50, Val Loss: 1.0590, Val Acc: 78.94%
验证准确率未提升，早停计数: 7/10
Epoch 43/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [02:09<00:00,  1.32s/it]
Epoch 43, Batch 0, Loss: 0.7864, learning_rate: 0.000036
Epoch 43, Batch 30, Loss: 0.7817, learning_rate: 0.000035
Epoch 43, Batch 60, Loss: 0.7711, learning_rate: 0.000034
Epoch 43, Batch 90, Loss: 0.7861, learning_rate: 0.000034
Epoch [43/50] - Loss: 0.8021, Accuracy: 86.60%
Starting validation...
Validation Loss: 1.0406, Validation Accuracy: 79.49%
Epoch 43/50, Val Loss: 1.0406, Val Acc: 79.49%
删除旧的最佳模型: ./checkpoints/ViT_Original_0410_Val_Epoch35_Acc79.34.pth
保存模型到 ./checkpoints/ViT_Original_0410_Val_Epoch43_Acc79.49.pth
Epoch 44/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [02:09<00:00,  1.32s/it]
Epoch 44, Batch 0, Loss: 0.8211, learning_rate: 0.000033
Epoch 44, Batch 30, Loss: 0.8295, learning_rate: 0.000033
Epoch 44, Batch 60, Loss: 0.8231, learning_rate: 0.000032
Epoch 44, Batch 90, Loss: 0.7781, learning_rate: 0.000031
Epoch [44/50] - Loss: 0.8014, Accuracy: 86.62%
Starting validation...
Validation Loss: 1.0503, Validation Accuracy: 79.21%
Epoch 44/50, Val Loss: 1.0503, Val Acc: 79.21%
验证准确率未提升，早停计数: 1/10
Epoch 45/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [02:08<00:00,  1.32s/it]
Epoch 45, Batch 0, Loss: 0.7846, learning_rate: 0.000031
Epoch 45, Batch 30, Loss: 0.8438, learning_rate: 0.000030
Epoch 45, Batch 60, Loss: 0.7725, learning_rate: 0.000029
Epoch 45, Batch 90, Loss: 0.8130, learning_rate: 0.000029
Epoch [45/50] - Loss: 0.7921, Accuracy: 87.01%
Starting validation...
Validation Loss: 1.0525, Validation Accuracy: 79.44%
Epoch 45/50, Val Loss: 1.0525, Val Acc: 79.44%
验证准确率未提升，早停计数: 2/10
Epoch 46/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [02:10<00:00,  1.33s/it]
Epoch 46, Batch 0, Loss: 0.7633, learning_rate: 0.000029
Epoch 46, Batch 30, Loss: 0.7471, learning_rate: 0.000028
Epoch 46, Batch 60, Loss: 0.7612, learning_rate: 0.000027
Epoch 46, Batch 90, Loss: 0.8078, learning_rate: 0.000026
Epoch [46/50] - Loss: 0.7905, Accuracy: 87.17%
Starting validation...
Validation Loss: 1.0620, Validation Accuracy: 79.41%
Epoch 46/50, Val Loss: 1.0620, Val Acc: 79.41%
验证准确率未提升，早停计数: 3/10
Epoch 47/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 98/98 [02:10<00:00,  1.33s/it]
Epoch 47, Batch 0, Loss: 0.8085, learning_rate: 0.000026
Epoch 47, Batch 30, Loss: 0.7638, learning_rate: 0.000026
Epoch 47, Batch 60, Loss: 0.8106, learning_rate: 0.000025
Epoch 47, Batch 90, Loss: 0.7908, learning_rate: 0.000024
Epoch [47/50] - Loss: 0.7830, Accuracy: 87.45%
Starting validation...
Validation Loss: 1.0911, Validation Accuracy: 78.59%
Epoch 47/50, Val Loss: 1.0911, Val Acc: 78.59%
验证准确率未提升，早停计数: 4/10
Epoch 48/50:  22%|███████████████████████████████████                                                                                                                         | 22/98 [00:33<01:55,  1.52s/it]
Epoch 48, Batch 0, Loss: 0.8002, learning_rate: 0.000024
Traceback (most recent call last):
  File "/data/coding/deep_learning_experiments/experiment2/start.py", line 87, in <module>
    train_model(model, train_loader, val_loader, criterion, optimizer, scheduler,num_epochs)
  File "/data/coding/deep_learning_experiments/experiment2/trainer.py", line 55, in train_model
    loss.backward()
  File "/data/miniconda/envs/cv/lib/python3.10/site-packages/torch/_tensor.py", line 521, in backward
    torch.autograd.backward(
  File "/data/miniconda/envs/cv/lib/python3.10/site-packages/torch/autograd/__init__.py", line 289, in backward
    _engine_run_backward(
  File "/data/miniconda/envs/cv/lib/python3.10/site-packages/torch/autograd/graph.py", line 769, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt
